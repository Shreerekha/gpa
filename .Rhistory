head(hatvalues(fit))
sigma= sqrt(deviance(fit)/residual.df)
sigma= sqrt(deviance(fit)/residual.df)
sigma= sqrt(deviance(fit)/resid(fit)$df
sigma= sqrt(deviance(fit)/resid(fit)$df)
sigma= sqrt(deviance(fit)/resid.df(fit))
sigma
sigma= sqrt(deviance(fit)
sigma= sqrt(deviance(fit))
sigma <- sqrt(deviance(fit)/df.residual(fit))
rstd <- resid(fit)/sigma*sqrt(1-hatvalues(fit))
rstd <- resid(fit)/(sigma*sqrt(1-hatvalues(fit)))
head(cbind(rstd, rstandard(fit)))
Use plot(fit, which=3)
plot(fit, which=3)
plot(fit, which=2)
sigma1 <- sqrt(devaince(fitno)/df.residual(fitno))
sigma1 <- sqrt(deviance(fitno)/df.residual(fitno))
resid(fit)[1] / sigma1* sqrt(1-hatvalues(fit)[1]
resid(fit)[1] / (sigma1*sqrt(1-hatvalues(fit)[1])
resid(fit)[1] / (sigma1*sqrt(1-hatvalues(fit)[1]))
head(rstudent(fit))
q
dy <- predict(fitno, out2)-predict(fit, out2)
sum(dy^2)/2*sigma^2
sum(dy^2)/(2*sigma^2)
plot(fit,which=5)
plot(fit9,which =1)
plot(fit9,which =1)
plot(fit9,which =1)
View(dfbeta(fit9))
View(hatvalues(fit9))
resid(fit9)
plot(fit9, which=3)
plot(fit9,which=5)
summary(mtcars)
?knitr
library.knitr
library(dplyr)
mtcarsbytran <-group_by(mtcars, am)
meanbytran <- summarise(mtcarsbytran, mean(mpg))
meanbytran
```{r, echo= FALSE, message=FALSE}
?motorcars
?mtcars
a<- subset(mtcars, am==0)
b<- subset(mtcars, am==1)
t.test(a$mpg, b$mpg)
t.test(mpg~am, data=mtcars)
data(mtcars)
fit9 <-lm(mpg~ factor(am)*wt+ hp*wt, mtcars)
h <- summary(fit9)
t.test(mtcars$mpg ~predict(fit9))
predict(fit9)
View(predict(fit9))
predict(fit9)$x
predict(fit9)[,2]
j <- predict(fit9)
j[1]
names(j)<- c("prediction")
View(j)
t.test(mtcars$mpg ~j)
t.test(mtcars$mpg, j)
j <- cbind(j,mtcars$mpg)
View(j)
mean(j)
mean(j$V2)
mean(j[,2])
x<- j[,1]-j[,2]
cbbind(j, x)
j<- cbind(j,x)
View(j)
mean(x)
install.packages("leaps")
library(leaps)
?leaps
reg.subsets(mpg~., data=mtcars, method="exhaustive")
regsubsets(mpg~., data=mtcars, method="exhaustive")
regsubsets(mpg~., data=mtcars, method="backward")
b <-regsubsets(mpg~., data=mtcars, method="backward")
summary(b)
b <-regsubsets(mpg~., data=mtcars, method="exhaustive")
summary(b)
b <-regsubsets(mpg~., data=mtcars, method="exhaustive", nvmax= 4)
summary(b)
cor(mtcars$mpg, mtcars$qsec)
cor(mtcars$mpg, mtcars$cyl)
cor(mtcars$mpg, mtcars$hp)
cor(mtcars$cyl, mtcars$hp)
cor(mtcars$cyl, mtcars$qsec)
cor(mtcars$hp, mtcars$qsec)
cor(mtcars$mpg, mtcars$disp)
cor(mtcars$cyl, mtcars$disp)
cor(mtcars$hp, mtcars$disp)
b <-regsubsets(mpg~., data=mtcars, method="exhaustive", nvmax= 3)
summary(b)
b <-regsubsets(mpg~., data=mtcars, method="backward", nvmax= 3)
summary(b)
b <-regsubsets(mpg~., data=mtcars, method="backward", nvmax= 4)
summary(b)
fit9 <-lm(mpg~ factor(am)*wt+ hp*wt, mtcars)
h <- summary(fit9)
fit12 <-lm(mpg~ factor(am)*wt+ hp*wt+qsec, mtcars)
m <- summary(fit12)
anova(fit12,fit9)
lrtest(fit12, fit9)
fit12 <-lm(mpg~ factor(am)*wt+ cyl*wt+qsec, mtcars)
m <- summary(fit12)
anova(fit12,fit9)
lrtest(fit12, fit9)
fit12 <-lm(mpg~ factor(am)*wt+ cyl*wt, mtcars)
m <- summary(fit12)
anova(fit12,fit9)
fit12 <-lm(mpg~ factor(am)*wt+ hp*wt+cyl, mtcars)
m <- summary(fit12)
anova(fit12,fit9)
? step
summary(fits <- lm(mpg ~., data="mtcars"))
summary(fits <- lm(mpg ~.,"mtcars"))
summary(fits <- lm(mpg ~.,mtcars))
summary(fits <- lm(mpg ~.,mtcars))
slm1 <- step(fits, direction = "both")
summary(slm1)
summary(fit9)
fit12 <-lm(mpg~ factor(am)*wt+ hp*wt+qsec, mtcars)
m <- summary(fit12)
anova(fit12,fit9)
m
?t.test
?cor
cor(mtcars$mpg, mtcars$am)
cor(mtcars$mpg, mtcars$wt)
?mtcars
cor(mtcars$mpg, mtcars$qsec)
cor(mtcars$mpg, mtcars$cyl)
cor(mtcars$mpg, mtcars$hp)
cor(mtcars$mpg, mtcars$disp)
cor(mtcars$mpg, mtcars$drat)
cor(mtcars$mpg, mtcars$vs)
cor(mtcars$mpg, mtcars$gear)
cor(mtcars$mpg, mtcars$carb)
fits <- lm(mpg ~ ., mtcars)
fits <- lm(mpg ~ ., mtcars)
vars <- step(fits, direction = "both")
summary(vars)
?step
data(mtcars)
cor(mtcars$wt, mtcars$cyl)
cor(mtcars$wt, mtcars$qsec)
cor(mtcars$wt, mtcars$hp)
cor(mtcars$wt, mtcars$disp)
cor(mtcars$wt, mtcars$drat)
cor(mtcars$wt, mtcars$vs)
cor(mtcars$wt, mtcars$gear)
cor(mtcars$wt, mtcars$carb)
cor(mtcars$hp, mtcars$cyl)
cor(mtcars$mpg, mtcars$cyl)
cor(mtcars$mpg, mtcars$hp)
cor(mtcars$am, mtcars$carb)
cor(mtcars$qsec, mtcars$carb)
fits <- lm(mpg ~ ., mtcars)
vars <- step(fits, direction = "both")
summary(vars)
vars$anova
fits <- lm(mpg ~ ., mtcars)
vars <- step(fits, direction = "both")
summary(vars)
fits <- lm(mpg ~ ., mtcars)
vars <- summary(step(fits, direction = "both"))
summary(vars)
fits <- lm(mpg ~ ., mtcars)
v <- step(fits, direction = "both")
summary(v)
cor(mtcars$qsec, mtcars$am)
cor(mtcars$wt, mtcars$am)
or(mtcars$mpg, mtcars$am)
cor(mtcars$mpg, mtcars$wt)
cor(mtcars$wt, mtcars$cyl)
cor(mtcars$wt, mtcars$qsec)
cor(mtcars$hp, mtcars$cyl)
cor(mtcars$mpg, mtcars$qsec)
cor(mtcars$mpg, mtcars$cyl)
cor(mtcars$mpg, mtcars$hp)
cor(mtcars$mpg, mtcars$disp)
cor(mtcars$mpg, mtcars$drat)
cor(mtcars$mpg, mtcars$vs)
cor(mtcars$mpg, mtcars$gear)
cor(mtcars$mpg, mtcars$carb)
cor(mtcars$wt, mtcars$disp
or(mtcars$wt, mtcars$disp)
cor(mtcars$wt, mtcars$disp)
fit1 <- lm(mpg~ wt+qsec+am, mtcars)
fit2 <- lm(mpg~ wt*am +qsec, mtcars)
fit3 <-lm(mpg ~wt*am*qsec, mtcars)
anova(fit1,fits)
anova(fit2, fit1)
anova(fit3,fit2)
?lm
summary(fit2)
fit1 <- lm(mpg~ am+wt+qsec, mtcars)
fit2 <- lm(mpg~ am*wt +qsec, mtcars)
fit3 <-lm(mpg ~wt*am*qsec, mtcars)
anova(fit1,fits)
anova(fit2, fit1)
anova(fit3,fit2)
fit1 <- lm(mpg~ factor(am)+wt+qsec, mtcars)
fit2 <- lm(mpg~ factor(am)*wt +qsec, mtcars)
fit3 <-lm(mpg ~wt*factor(am)*qsec, mtcars)
anova(fit1,fits)
anova(fit2, fit1)
anova(fit3,fit2)
summary(fit2)
fit9 <-lm(mpg~ factor(am)*wt+ hp*wt, mtcars)
anova(fit9, fit2)
library(lmtest)
lrtest(fit9, fit2)
anova(fit2)
plot(fit2)
mfrow(2,2)
plot(fit2, which =1)
plot(fit2, which =2)
plot(fit2, which=3)
plot(fit3, which =4)
lot(fit2, which =1)
plot(fit2, which =1)
plot(fit2, which =2)
plot(fit2, which=3)
plot(fit3, which =4)
plot(fit3, which =5)
plot(fit2)
par(mfrow(2,2))
plot(fit2, which =1)
plot(fit2, which =2)
plot(fit2, which=3)
plot(fit3, which =5)
main = "Fig. 2 Residual Plots and Diagnostics"
par(mfrow= c(2,2))
plot(fit2, which =1)
plot(fit2, which =2)
plot(fit2, which=3)
plot(fit3, which =5)
main = "Fig. 2 Residual Plots and Diagnostics"
par(mfrow= c(2,2))
plot(fit2)
par(mfrow= c(2,2))
plot(fit2, main = "Fig. 2 Residual Plots and Diagnostics")
par(mfrow= c(2,2))
plot(fit2)
a<- resid(fit2)
mean(a)
?plot
?plot
?fit
?lm
fit2$coefficients
fit2$residuals
resid(fit2)
df.residual
fit2$df.residual
?summary(fit)
sum <- summary(fit2)
sum$coefficients
sum$.adj.r.squared
sum
sum$cov.unscaled
sum$r.squared
sum$adj.r.squared
max(mtcars$mpg-predict(fit2))
mean(mtcars$mpg-predict(fit2))
resid(fit2)
mean(resid(fit2))
a<- dfbeta(fit2)
View(dfbeta)
View(a)
names(mtcars)
dim(mtcars)
str(mtcars)
mean(resid(fit2))
anova(fit2, fits)
`
fit2$adj.r.squared
mean(resid(sum))
sumbest <-summary(fit2)
?summary(fit)
mean(sumbest$residuals)
cat("xxx", 3)
h<- t.tests(mtcars$mpg~mtcars$am)
h<- t.test(mtcars$mpg~mtcars$am)
?t.test
h$statistic
h$p.value
h$estimate
class(mtcars)
?vif
library(usdm)
?vif
x>- data.frame()
x<- data.frame()
x<- c(mtcars$am, mtcars$wt, mtcars$$qsec)
x<- c(mtcars$am, mtcars$wt, mtcars$qsec)
vifstep(x, th=10)
class(x)
x<- cbind(mtcars$am, mtcars$wt, mtcars$qsec)
class(x)
vifstep(x, th=10)
vifcor(x, 0.9)
library(lmtest)
dwtest(fit2)
bptest(fit2, studentize = TRUE)
pairs(mtcars, panel = panel.smooth, main = "Mt Cars data", col = 3 )
pairs(mtcars, panel = panel.smooth, main = "Mt Cars data", col = 3 +mtcars$am)
class(names(mtcars))
sapply(mtcars, class)
?predict
predict(fit2, interval = "confidence")
mpgbar <- mean(mtcars$mpg)
ssr<- sum((mtcars$mpg-mpgbar)^2)
mpghat<- predict(fit2)
headmpghat
head(mpghat)
sse<- sum((mtcars$mpg-mpghat)^2)
sst <- ssr+sse
ssr/sst
ssr<- sum((mpghat-mpgbar)^2)
sst <- ssr+sse
ssr/sst
mpgbar<-mean(mtcars$mpg)
mpghat<- predict(fit2)
ssr<- sum((mpghat-mpgbar)^2)) # variation explained by model
sse <- sse<- sum((mtcars$mpg-mpghat)^2) # unexplated variation
sse<- sum((mtcars$mpg-mpghat)^2)
sst<- sum((mtcars$mpg-mpgbar)^2)
sst
ssr+sse
rexp <- round((ssr*100/sst),2)
rexp
mpgbar<-mean(mtcars$mpg)
mpghat<- predict(fit2)
ssr<- sum((mpghat-mpgbar)^2) # variation explained by model
sse<- sum((mtcars$mpg-mpghat)^2) # unexplained variation
sst<- sum((mtcars$mpg-mpgbar)^2)
rexp <- round((ssr*100/sst),2)
confint(fit2)
?confint
confint(fit2, level =0.95)
summary(fit2)
cor(mtcars$mpg, mtcars$am);cor(mtcars$mpg, mtcars$wt); cor(mtcars$wt, mtcars$cyl)
cor(mtcars$mpg, mtcars$qsec)
cor(mtcars$mpg, mtcars$cyl)
cor(mtcars$mpg, mtcars$hp)
cor(mtcars$mpg, mtcars$disp)
cor(mtcars$mpg, mtcars$drat)
cor(mtcars$mpg, mtcars$vs)
cor(mtcars$mpg, mtcars$gear)
cor(mtcars$mpg, mtcars$carb)
cor(mtcars$wt, mtcars$hp)
cor(mtcars$wt, mtcars$disp)
cor(mtcars$wt, mtcars$drat)
cor(mtcars$wt, mtcars$vs)
cor(mtcars$wt, mtcars$gear)
cor(mtcars$wt, mtcars$carb)
cor(mtcars$qsec, mtcars$am)
cor(mtcars$wt, mtcars$am)
cor(mtcars$wt, mtcars$qsec)
cor(mtcars$hp, mtcars$cyl)
fits <- lm(mpg ~ ., mtcars);v <- step(fits, direction = "both");summary(v)
hat.values(fit2)
?influence.measures
hatvalues(fit2)
max(hatvalues(fit2))
mean(hatvalues(fit2))
plot(hatvalues(fit2), type = "h")
```{r, echo=FALSE, message=FALSE}
library(lmtest); bptest(fit2, studentize = TRUE)
?bptest
library(lmtest);  dwtest(fit2)
?dwtest
``{r,echo= FALSE, message=FALSE}
x<- data.frame();x<- cbind(mtcars$am, mtcars$wt, mtcars$qsec);
library(usdm); vifstep(x, th=10)
?vif
vifstep$coefficients
vifstep$coefficient
?vif
v <- step(fits, direction = "both");summary(v)
fits <- lm(mpg ~ ., mtcars);v <- step(fits, direction = "both");summary(v)
v
fit1<- lm(mpg ~ cyl + hp + wt + am, data = mtcars)
y<- data.frame();y<- cbind(mtcars$am, mtcars$wt, mtcars$cyl, mtcar$hp);
y<- data.frame();y<- cbind(mtcars$am, mtcars$wt, mtcars$cyl, mtcars$hp);
vif <- vifstep(y, th=10)
library(usdm)
vif <- vifstep(y, th=10)
vif
vif <- vifcor(y, 0.9)
vif
summary(fit1)
mean(resid(fit1))
dw<-dwtest(fit2)
library(lmtest)
dw<-dwtest(fit2)
dw<-dwtest(fit1)
dw
bp <- bptest(fit1, studentize = TRUE)
bp
fits <- lm(mpg ~ ., mtcars);v <- step(fits, direction = "both");summary(v)
summary(v)
sumbest <-summary(fit2);print("Summary of Best Linear Model"); sumbest
fit2 <- lm(mpg~ factor(am)*wt +qsec, mtcars)
sumbest <-summary(fit2);print("Summary of Best Linear Model"); sumbest
wt=3
mpg = 9.723 - 2.937*wt
mpg
23.802 - 7.078*wt
=2.568/.912
2.568/.912
mtcars$wt
wt <- c(1:5.5, step=0.5)
mpgam <-9.723-2.937*wt
mpgmm <-23.802-7.078*wt
x <- cbind(wt, mpgam, mpgmm)
View(x)
mtcars$qsec
?rep
?vector
wt<-c(1:5.5, by =0.5)
wt<-seq(1:5.5, 0.5)
wt<-seq(1, 5.5, 0.5)
wt
mpgam <-9.723-2.937*wt +1.017*mtcars$qsec
mpgam <-9.723-2.937*mtcars$wt +1.017*mtcars$qsec
mpgam <-9.723-2.937*mtcars$wt +1.017*mtcars$qsec
mpgmm <-23.802-7.078*mtcars$wt+1.017*mtcars$qsec
mpg= 9.723+ 14.079*mtcars$am-2.937*mtcars$wt+ 1.017*mtcars$qsec-4.141*mtcars$wt *mtcars$am
a <- cbind(mpg, predict(fit2))
fit2 <- lm(mpg~ factor(am)*wt +qsec, mtcars)
a <- cbind(mpg, predict(fit2))
View(a)
a <- cbind(a, mpgam, mpgmm)
View(a)
a <- cbind(a,mtcars$am)
View(a)
rm(a)
a <- cbind(mtcars$mpg, mpg, predict(fit2),mtcars$am)
View(a)
b <- a[,1]-a[,3]
a <- cbind(a,b)
View(a)
?wt
?mtcars
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
?lines
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
?text
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
?raidoButtons
?radioButtons
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
?line
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
?hist
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
shiny::runApp('D:/Rekha/Rekha_Docs/Data_Science/Dataproducts/gpa')
setwd("D:/Rekha/Rekha_Docs/Data_Science/Dataproducts")
shiny::runApp('gpa')
